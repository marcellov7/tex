const defaultParagraphSeparatorString="defaultParagraphSeparator",formatBlock="formatBlock",addEventListener=(a,b,c)=>a.addEventListener(b,c),appendChild=(a,b)=>a.appendChild(b),createElement=a=>document.createElement(a),queryCommandState=a=>document.queryCommandState(a),queryCommandValue=a=>document.queryCommandValue(a),exec=(a,b=null)=>document.execCommand(a,!1,b),defaultActions={fontSize:{icon:"\uD83D\uDDDA",title:"Font Size",result:(a,b)=>{let c=document.getElementById("fontSizeSelect");if(!c){c=document.createElement("select"),c.id="fontSizeSelect";[3,4,5,6,7].forEach(a=>{const b=document.createElement("option");b.value=a,b.textContent=a,c.appendChild(b)}),b.parentNode.insertBefore(c,b.nextSibling),c.addEventListener("change",()=>{const a=c.value;exec("fontSize",a+"px")})}else c.parentNode.removeChild(c)}},bold:{icon:"<b>B</b>",title:"Bold",state:()=>queryCommandState("bold"),result:()=>exec("bold")},italic:{icon:"<i>I</i>",title:"Italic",state:()=>queryCommandState("italic"),result:()=>exec("italic")},underline:{icon:"<u>U</u>",title:"Underline",state:()=>queryCommandState("underline"),result:()=>exec("underline")},removeFormat:{icon:"\u232B",title:"Remove Format",result:()=>exec("removeFormat")},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:()=>queryCommandState("strikeThrough"),result:()=>exec("strikeThrough")},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:()=>exec(formatBlock,"<h1>")},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:()=>exec(formatBlock,"<h2>")},paragraph:{icon:"&#182;",title:"Paragraph",result:()=>exec(formatBlock,"<p>")},quote:{icon:"&#8220; &#8221;",title:"Quote",result:()=>exec(formatBlock,"<blockquote>")},olist:{icon:"&#35;",title:"Ordered List",result:()=>exec("insertOrderedList")},ulist:{icon:"&#8226;",title:"Unordered List",result:()=>exec("insertUnorderedList")},code:{icon:"&lt;/&gt;",title:"Code",result:()=>exec(formatBlock,"<pre>")},line:{icon:"&#8213;",title:"Horizontal Line",result:()=>exec("insertHorizontalRule")},link:{icon:"&#128279;",title:"Link",result:()=>{const a=window.prompt("Enter the link URL");a&&exec("createLink",a)}},image:{icon:"Img",title:"Image",result:()=>{const a=window.prompt("Enter the image URL");a&&exec("insertImage",a)}},html:{icon:"HTML",title:"Html",result:a=>{const b=a.parentNode,c=b.querySelector(".htmlContent"),d=b.querySelector(".tex-content");c&&("none"===c.style.display?(c.style.display="block",d.style.display="none"):(c.style.display="none",d.style.display="block"))}},textColor:{icon:"<span>A</span>",title:"Text Color",result:(a,b)=>{let c=document.getElementById("textColorInput");c?c.parentNode.removeChild(c):(c=document.createElement("input"),c.id="textColorInput",c.type="color",c.addEventListener("input",()=>{exec("foreColor",c.value),b.style.color=c.value}),b.parentNode.insertBefore(c,b.nextSibling))}},textBackColor:{icon:"<span style=\"padding:3px; background:lightgray;\">A</span>",title:"Text Color",result:(a,b)=>{let c=document.getElementById("textColorInput");c?c.parentNode.removeChild(c):(c=document.createElement("input"),c.id="textColorInput",c.type="color",c.addEventListener("input",()=>{exec("backColor",c.value),b.querySelector("span").style.background=c.value}),b.parentNode.insertBefore(c,b.nextSibling))}},indent:{icon:"&rsaquo;",title:"Indent",result:()=>exec("indent")},outdent:{icon:"&lsaquo;",title:"Outdent",result:()=>exec("outdent")},clearFormatting:{icon:"\u2612",title:"Clear Formatting",result:()=>exec("removeFormat")},undo:{icon:"\u21B6",title:"Undo",result:()=>exec("undo")},redo:{icon:"\u21B7",title:"Redo",result:()=>exec("redo")},justifyCenter:{icon:"\u21E5\u21E4",title:"Justify Center",result:()=>exec("justifyCenter")},justifyFull:{icon:"\u21E4\u21E5",title:"Justify Full",result:()=>exec("justifyFull")},justifyLeft:{icon:"\u21E4",title:"Justify Left",result:()=>exec("justifyLeft")},justifyRight:{icon:"\u21E5",title:"Justify Right",result:()=>exec("justifyRight")}},defaultClasses={actionbar:"tex-actionbar",button:"tex-button",content:"tex-content tex-editor",selected:"tex-button-selected"},destroy=a=>{const b=document.querySelector(`[tex-id="${a.id}"]`),c=document.getElementById(a.id),d=b.querySelector(".tex-content"),e=b.querySelector(".tex-actionbar");if(b){const a=d.cloneNode(!0);d.parentNode.replaceChild(a,d);const f=e.cloneNode(!0);e.parentNode.replaceChild(f,e),f.remove(),"textarea"===c.tagName.toLowerCase()?(c.style.display="block",b.remove()):(b.innerHTML=a.innerHTML,b.removeAttribute("tex-id"),b.classList.remove("theme-light","theme-dark","tex-container"))}},getContent=a=>{const b=document.querySelector(`[tex-id="${a.id}"]`),c=b.querySelector(".tex-content");return c.innerHTML},init=a=>{const b=a.theme||"light",c={...defaultClasses,...a.classes},d=a[defaultParagraphSeparatorString]||"div",e=createElement("div");e.className="tex-container",e.classList.add(`theme-${b}`),e.setAttribute("tex-id",a.element.id);const f=createElement("div");f.className=c.actionbar,appendChild(e,f);const g=a.element.content=createElement("div");g.contentEditable=!0,g.className=c.content,g.innerHTML="textarea"===a.element.tagName.toLowerCase()?a.element.value:a.element.innerHTML,g.onkeydown=a=>{"Enter"===a.key&&"blockquote"===queryCommandValue(formatBlock)&&setTimeout(()=>exec(formatBlock,`<${d}>`),0)},appendChild(e,g),appendChild(a.element.parentNode,e);let h=[];a.buttons?h=a.buttons.map(a=>{const b=defaultActions[a];if(b)return{icon:b.icon,title:b.title,key:a,result:b.result}}).filter(a=>void 0!==a):a.actions&&(h=a.actions.map(a=>"string"==typeof a?defaultActions[a]:"custom"===a.name?{icon:a.icon,title:a.title,result:a.result}:defaultActions[a.name]?{...defaultActions[a.name],...a}:a)),h.forEach(a=>{const b=createElement("button");if(b.className=c.button,b.innerHTML=a.icon,b.title=a.title,b.setAttribute("type","button"),b.onclick=()=>a.result(g,b)&&g.focus(),a.state){const d=()=>b.classList[a.state()?"add":"remove"](c.selected);addEventListener(g,"keyup",d),addEventListener(g,"mouseup",d),addEventListener(b,"click",d)}appendChild(f,b)}),a.styleWithCSS&&exec("styleWithCSS"),exec(defaultParagraphSeparatorString,d),"textarea"===a.element.tagName.toLowerCase()?a.element.style.display="none":(document.getElementById(a.element.id).remove(),e.id=a.element.id);const i=createElement("textarea");return i.setAttribute("class","htmlContent"),appendChild(e,i),i.value=g.innerHTML,i.style.display="none",g.oninput=({target:{firstChild:b}})=>{b&&3===b.nodeType?exec(formatBlock,`<${d}>`):"<br>"===g.innerHTML&&(g.innerHTML=""),a.onChange(g.innerHTML),"textarea"===a.element.tagName.toLowerCase()&&(a.element.value=g.innerHTML),i.value=g.innerHTML},i.oninput=({target:{firstChild:b}})=>{g.innerHTML=i.value,a.element.value=g.innerHTML},a.element},tex={exec,init,destroy,getContent};export default tex;